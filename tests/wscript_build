# vim:set syntax=python:

lib = 'm' if ctx.env['DEST_OS'] not in ['win32', 'win64'] else None

uselib = []
uselib += ['FFTW3', 'FFTW3F']
uselib += ['SAMPLERATE']
uselib += ['SNDFILE']
uselib += ['AVCODEC']
uselib += ['AVFORMAT']
uselib += ['AVRESAMPLE']
uselib += ['AVUTIL']
uselib += ['JACK']
uselib += ['BLAS']

includes = ['../src', '.']

for target_name in ctx.path.ant_glob('src/**/*.c'):
    extra_source = []
    bld(features = 'c cprogram test',
            lib = lib,
            uselib = uselib,
            source = [target_name] + extra_source,
            target = str(target_name).split('.')[0],
            includes = includes,
            install_path = None,
            defines = 'AUBIO_UNSTABLE_API=1',
            cflags = ['-g'],
            use = 'aubio')
